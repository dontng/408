冲冲冲！铁子，这道题是408操作系统里的 **“天字一号”** 考点：**进程/线程、共享变量、互斥**。这道题的陷阱非常深，是区分“考研小白”和“105分稳了”的经典题目。



### 层次一：弄懂这道题 (Solving This Specific Problem)





#### 1. 题目解析 (Problem Analysis)



- **问题:** 哪些操作 **需要互斥** 执行？
- **核心：** 互斥是为了解决 **“竞争条件” (Race Condition)**。
- **竞争条件发生的两个前提：**
  1. **共享资源：** 两个或多个执行单元（线程/进程）访问 **同一个** 资源。
  2. **写操作：** 至少有一个执行单元对该资源进行 **写入**。



#### 2. “陷阱”分析：本题的执行单元是什么？



- **进程 P1** 和 **进程 P2**：
  - **重点：** 进程是资源分配的基本单位。P1 和 P2 拥有 **各自独立** 的地址空间。
  - P1 里的 `int x = 0;` 和 P2 里的 `int x = 0;` 是 **两个完全不同** 的变量，它们只是恰好同名而已。P1 修改自己的 `x`，对 P2 的 `x` **没有任何影响**。
- **线程 Thread1, Thread2 (在 P1 内):**
  - 线程是CPU调度的基本单位。P1 内的 T1 和 T2 **共享** P1 的全局变量，即 P1 的 `x`。
- **线程 Thread3, Thread4 (在 P2 内):**
  - T3 和 T4 **共享** P2 的全局变量，即 P2 的 `x`。
- **局部变量 `a`, `b`:**
  - `int a` 和 `int b` 都是在函数（线程）内部定义的局部变量，存储在 **各自的栈** 上，**不是共享资源**。



#### 3. 逐个分析选项 (Analyzing the Options)



- **A. `a=1` (在 T1) 与 `a=2` (在 T2)**
  - `a=1` 操作的是 T1 的局部变量 `a`。
  - `a=2` 操作的是 T2 的局部变量 `a`。
  - 它们是两个不同的变量。**不需要互斥**。
- **B. `a=x` (在 T3) 与 `b=x` (在 T4)**
  - `a=x` 读取 P2 的 **共享** `x`。
  - `b=x` 读取 P2 的 **共享** `x`。
  - 两者都是 **读操作 (Read)**。多个执行单元并发地“读”同一个资源是安全的，不会造成数据混乱。
  - **不需要互斥**。(注意：`a=x; x+=3;` 这 *一整块* 作为临界区需要和 T4 的 `b=x; x+=4;` 互斥，但题目只问 `a=x` 和 `b=x` 这两个 *读操作*。)
- **D. `x+=1` (在 T1) 与 `x+=3` (在 T3)**
  - `x+=1` 操作的是 **P1 进程的 `x`**。
  - `x+=3` 操作的是 **P2 进程的 `x`**。
  - 这是两个 **完全不同** 的变量。**不需要互斥**。
  - **[这是本题最大的陷阱！]**
- **C. `x+=1` (在 T1) 与 `x+=2` (在 T2)**
  - `x+=1` 操作的是 **P1 进程的共享 `x`**。
  - `x+=2` 操作的是 **P1 进程的共享 `x`**。
  - `x+=1` 不是原子操作，它至少包含“读-改-写”三步（`read x`, `add 1`, `write x`）。
  - `x+=2` 同理。
  - **满足所有条件：** ① 访问了 **同一个共享资源** (P1的 `x`)；② 都是 **写操作**。
  - 如果它们并发执行，就会发生竞争，导致结果错误（例如 `x` 的值最后是 1 或 2，而不是期望的 3）。
  - **必须进行互斥**。

**结论：** 答案选 **C**。

------



### 层次二：搞定这个考点 (Mastering This Topic)



这个考点是 **“临界资源 (Critical Resource)” 和 “临界区 (Critical Section)”** 的识别。

1. **第一步：识别“执行单元”**
   - 是 **进程 (Process)** 还是 **线程 (Thread)**？
   - 进程：内存**独立**。
   - 线程：内存**共享**（共享进程的全局变量和堆，但栈独立）。
2. **第二步：识别“共享资源”**
   - 全局变量？堆内存？
   - 局部变量（栈变量）？**绝对不是** 共享资源。
3. **第三步：识别“操作类型”**
   - `read` vs `read`：安全。
   - `read` vs `write`：**危险** (需要互斥)。
   - `write` vs `write`：**危险** (需要互斥)。
4. **`x += 1` 的本质：**
   - 一定要把 `x += 1`、`x++`、`count--` 这种操作在脑子里自动翻译成 **非原子** 的“读-改-写”三部曲，这是发生竞争的根源。

------



### 层次三：吃透这个体系 (Integrating into Your System)



1. **考点定位与价值：**
   - 这是你105分目标中的 **“地基”**。如果你这道题错了，说明你对“进程/线程”这个OS最基本模型的理解有偏差，后面的P/V操作、死锁等同体系的知识点你都学不踏实。
   - 这道题就是来 **“钓鱼”** 的，专门钓那些不仔细读题、把“进程 P1”和“进程 P2”误当成“线程 T1”和“线程 T2”的考生。
2. **给你的备考策略建议：**
   - **建立“审题防火墙”:** 在刷10年真题时，只要看到“进程”、“线程”同时出现的题目，立刻把笔点在“进程”这两个字上，提醒自己 **“内存隔离！”**。
   - **串联知识点：**
     - **上一题 (TSL)**：讲的是如何 *解决* 互斥问题。
     - **本题 (x+=1)**：讲的是 *为什么* 需要互斥。
     - 把这两道题连起来看：因为存在 `x+=1` 和 `x+=2` 这样的 **临界区**，所以我们才需要 `while(TSL(&lock));` 这样的 **加锁机制** 去保护它。
   - 你的105分，就是靠这样把一个个孤立的知识点串成一个无法攻破的知识体系。加油！